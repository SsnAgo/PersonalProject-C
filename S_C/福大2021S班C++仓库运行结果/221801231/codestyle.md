# 代码规范

## 缩进

#### 1.1程序块要采用缩进风格编写, 缩进的空格数为4个。

#### 1.2对齐只使用空格键，不使用TAB键。

## 变量命名

#### 2.1 标识符的命名要清晰、明了, 有明确含义, 同时使用完整的单词或大家基本可以理解的缩写, 避免使人产生误解。

说明: 较短的单词可通过去掉“元音”形成缩写; 较长的单词可取单词的头几个字母形成缩写; 一些单词有大家公认的缩写。

#### 2.2 命名中若使用特殊约定或缩写, 则要有注释说明。

说明: 应该在源文件的开始之处, 对文件中所使用的缩写或约定, 特别是特殊的缩写, 进行必要的注释说明。

#### 2.3  对于变量命名, 禁止取单个字符(如i、j、k… ), 建议除了要有具体含义外, 还能表明其变量类型、数据类型等, 但i、j、k 作局部循环变量是允许的。

#### 2.4 变量命名可以使用驼峰命名法，例如:int firstStudentName;

#### 2.5 全局变量要有较详细的注释，包括对其功能、取值范围、哪些函数或过程存取它以及存取时注意事项等的说明。

## 每行最多字符数

#### 3.1 较长的语句（>80字符）要分成多行书写。

说明：
以下情况应分多行书写：
1）长表达式要在低优先级操作符处划分新行，操作符放在新行之首，划分出的新行要进行适当的缩进，使排版整齐，语句可读。
2）若函数或过程中的参数较长，则要进行适当的划分。
3）循环、判断等语句中若有较长的表达式或语句，则要进行适应的划分，长表达式要在低优先级操作符处划分新行，操作符放在新行之首

## 函数最大行数

#### 4.1 函数的规模尽量限制在200 行以内

说明: 不包括注释和空格行。

## 函数、类命名

#### 5.1 对所调用函数的错误返回码要仔细、全面地处理

#### 5.2 明确函数功能, 精确(而不是近似)地实现函数设计

#### 5.3 编写可重入函数时, 应注意局部变量的使用(如编写C/C++ 语言的可重入函数时, 应使用auto 即缺省态局部变量或寄存器变量)

说明: 编写C/C++语言的可重入函数时, 不应使用static局部变量, 否则必须经过特殊处理, 才能使函数具有可重入性。

#### 5.4  编写可重入函数时, 若使用全局变量, 则应通过关中断、信号量(即P、V 操作)等手段对其加以保护

说明: 若对所使用的全局变量不加以保护, 则此函数就不具有可重入性, 即当多个进程调用此函数时, 很有可能使有关全局变量变为不可知状态。

#### 5.5 一个函数仅完成一件功能。

#### 5.6 不要设计多用途面面俱到的函数

说明: 多功能集于一身的函数, 很可能使函数的理解、测试、维护等变得困难。

#### 5.6 尽量不要编写依赖于其他函数内部实现的函数

说明: 此条为函数独立性的基本要求。由于目前大部分高级语言都是结构化的, 所以通过具体语言的语法要求与编译器功能, 基本就可以防止这种情况发生。但在汇编语言中, 由于其灵活性, 很可能使函数出现这种情况。

#### 5.7 建议：类、结构、联合、枚举的命名须分别以C、S、U、E开头，其他部分遵从一般变量命名规范。

#### 5.8  减少函数本身或函数间的递归调用

#### 5.9  函数命名单词首字母大写，形式可以是“函数名_描述函数功能的动词”，尽量写出主谓格式。

## 常量

#### 6.1 规则：常量、宏和模板名采用全大写的方式，每个单词间用下划线分隔。

#### 6.2 建议：枚举类型enum 常量应以大写字母开头或全部大写。

## 空行规则

#### 7.1 规则：代码行之内应该留有适当的空格说明：

采用这种松散方式编写代码的目的是使代码更加清晰。代码行内应该适当的使用空格，具体如下：
1）关键字之后要留空格。象const、virtual、inline、case等关键字之后至少要留一个空格，否则无法辨析关键字 象if、for、while等关键字之后应留一个空格再跟左括号‘（’，以突出关键字。
2）函数名之后不要留空格，紧跟左括号’(’，以与关键字区别。

3）‘(’向后紧跟，‘ )’、‘，’、‘;’向前紧跟，紧跟处不留空格
4）‘,’之后要留空格， 如Function(x,y,z)。如果‘;’不是一行的结束符号，后也要留空格，
5）值操作符、比较操作符、算术操作符、逻辑操作符、位域操作符，如“=”、“+=”“>=”、“<=”、“+”、“*”、“%”、“&&”、“||”、“<<、“^”等二元操作符的前后应当加空格。
6）一元操作符如“!”、“~”、“++”、“–”、“&”（地址运算符）等前后不加空格。
7）象“［］”、“.”、“->” 这类操作符前后不加空格。

## 注释规则

#### 8.1：一般情况下，源程序有效注释量必须在20％以上。

#### 8.2：文件头部应进行注释，注释必须列出：版权说明、版本号、生成日期、作者、内容、功能、修改日志等。

#### 8.3：函数头部应进行注释，列出：函数的目的/功能、输入参数、输出参数、返回值、调用关系（函数、表）等。

#### 8.4：边写代码边注释，修改代码同时修改相应的注释，以保证注释与代码的一致性。不再有用的注释要删除。

#### 8.5：注释的内容要清楚、明了，含义准确，防止注释二义性。

#### 8.6：注释应与其描述的代码相近，对代码的注释应放在其上方或右方（对单条语句的注释）相邻位置，不可放在下面，如放于上方则需与其上面的代码用空行隔开。

#### 8.7：变量、常量、宏的注释应放在其上方相邻位置或右方。

#### 8.8：对数据结构的注释应放在其上方相邻位置，不可放在下面；对结构中的每个域的注释放在此域的右方。

#### 8.9：全局变量要有较详细的注释，包括对其功能、取值范围、哪些函数或过程存取它以及存取时注意事项等的说明。

#### 8.10：注释与所描述内容进行同样的缩排。

#### 8.11：避免在一行代码或表达式的中间插入注释。

#### 8.12：通过对函数或过程、变量、结构等正确的命名以及合理地组织代码的结构，使代码成为自注释的。

#### 8.13：注释格式尽量统一，注释格式用//

#### 8.14：将注释与其上面的代码用空行隔开

#### 8.15：对变量的定义和分支语句（条件分支、循环语句等）必须编写注释。

说明：这些语句往往是程序实现某一特定功能的关键，对于维护人员来说， 良好的注释帮助更好的理解程序，有时甚至优于看设计文档。

#### 8.16：对于 switch 语句下的case 语句，如果因为特殊情况需要处理完一个 case 后进入下一个 case 处理，必须在该case 语句处理完、下一个 case 语句前加上明确的注释。 有效防止无故遗漏 break 语句。

## 操作符前后空格

#### 在两个以上的关键字、变量、常量进行对等操作时，它们之间的操作符之 前、之后或者前后要加空格；进行非对等操作时，如果是关系密切的立即操作符 （如－>），后不应加空格。 采用这种松散方式编写代码的目的是使代码更加清晰。

(1) 逗号、分号只在后面加空格。
int a, b, c;
(2)比较操作符, 赋值操作符”=”、”+=”，算术操作符”+”、”%”，逻辑操
作符”&&”、”&”，位域操作符”<<”、”^”等双目操作符的前后加空格。
a = b + c;
(3)”!”、”~”、”++”、”–”、”&”（地址运算符）等单目操作符前后不加
空格。
p = ‘a’; // 内容操作”“与内容之间
flag = !isEmpty; // 非操作”!”与内容之间
p = &mem; // 地址操作”&” 与内容之间
i++; // “++”,”–”与内容之间
(4)”->”、”.”前后不加空格。
p->id = pid; // “->”指针前后不加空格
(5) if、for、while、switch 等与后面的括号间应加空格，使if等关
键字更为突出、明显。
if (a >= b && c > d)
(6)可以用括号来明确运算顺序。
(7).符合赋值运算符+=不能用空格空开。

## 其他规则

#### 9.1不要滥用goto 语句。

说明: goto语句会破坏程序的结构性, 所以除非确实需要, 最好不使用goto语句。

#### 9.2 时刻注意表达式是否会上溢、下溢

#### 9.3 使用变量时要注意其边界值的情况

#### 9.4 要时刻注意易混淆的操作符。当编完程序后, 应从头至尾检查一遍这些操作符, 以防止拼写错误

#### 9.5 有可能的话, if 语句尽量加上else 分支, 对没有else 分支的语句要小心对待; switch 语句必须有default分支

#### 9.6 防止引用已经释放的内存空间

说明: 在实际编程过程中, 稍不留心就会出现在一个模块中释放了某个内存块(如C语言指针), 而另一模块在随后的某个时刻又使用了它。要防止这种情况发生。